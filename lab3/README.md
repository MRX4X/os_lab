#  Лабораторная работа по написанию отказоустойчивого сервиса на сетевые ресурсы
## Письменная информация о файлах

### Конфигурационного файл "ansible.cfg"
В конфигурационном файле добавляем параметры:
1. Добавляем созданный inventory файл
2. Добавляем "vagrant" пользователя для работы
3. Значение "host_key_checking" ставим False
4. Значение defualt_transport указываем "smart"


### Создание inventory файла
С помощью "inventory" файла будет указанно на каких хостах нужно выполнить сценарий "ansible", в нашем случае указываем ip двух веб-серверов, а также ip балансеров haproxy.


### Playbook nginx.yml
Установка nginx репозитории на заданной роли-машине webserver отключение службы selinux, установка балансировщика нагрузки haproxy и установка вспомогательного балансировщика keepalive. 


### Roles balancer
Данная роль отвечает за распределение нагрузки на веб-ресурсы, используя алгоритмы сервиса haproxy, а также вспомогательный сервис keepalive, который контролирует работоспособность веб-ресуров, и в случае проблемы на основном балансировщике, готов начать работу в за место основного.

### Roles webserver
Данная роль отвечает за настройку веб-сервера nginx на двух серверах с расположенными на них веб-ресурсами.


## Запуск сценариев
#### 1. Убедимся в работоспособности машины
Прописав "vagrant status", узнаем о текущем состоянии виртуальной машины. Если машина не запущенна, то требуется выполнить команду "vagrant up".
#### 2. Запуск плейбука nginx.yml
Прописав команду "ansible-playbook haproxy.yml" убедимся в работоспособности сценария.
Вывод должен быть следующим:
"nginx                      : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0"
## Результат проделанной работы
Открытие веб-страницы по адресу <http://192.168.11.113:8080> (ip балансера) должно происходить корректно. При обновлении страницы с очисткой кэша страницы, должно происходить заранее прописанное изменение в разметке веб-страницы на одной из веб-страничек для отличия их от друг друга, чтобы убедится в работоспособности балансировщика. Для проверки отказоустойчивости стоит отключить один из серверов, тогда haproxy может выстраивать альтернативные пути запрос-ответов серверов.
